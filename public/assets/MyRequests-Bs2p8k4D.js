import{b as je,u as ge,c as R,j as e}from"./vendor-query-BtlmzfbD.js";import{r as m,u as Ie,a as Se,d as Be,N as Me}from"./vendor-router-CyR0tpch.js";import{v as L,p as Qe,u as $e,c as H,t as ve}from"./index-Dc8JLFg6.js";import{C as q,c as M}from"./Card-CVFC4agM.js";import{B as p}from"./Button-C8xCGhNf.js";import{B as oe}from"./Badge-CLufSCSl.js";import{M as X}from"./Modal-it_GQaMG.js";import{I as le}from"./Input-DPOK3q6H.js";import{S as ae}from"./Select-DLsgzIyk.js";import{P as me,z as Ge,_ as He,$ as Ae,t as Ee,m as we,a0 as qe,Q as ne,a1 as Oe,X as Ce,Y as De,O as Z,F as ee,U as Ye,l as $,a2 as Le,a3 as se,o as xe,d as Ve,J as Te,a4 as Ke,D as Re,c as We,Z as Je,A as Xe}from"./vendor-icons-BMeEPn6p.js";import"./vendor-react-Cgg2GOmP.js";import"./vendor-axios-B9ygI19o.js";const ze=[{value:"vacation",label:"Vacaciones"},{value:"personal",label:"Día Personal"},{value:"sick",label:"Enfermedad"},{value:"bereavement",label:"Duelo"},{value:"unpaid",label:"Sin Goce"}],Ze=[{value:"",label:"Todos"},{value:"draft",label:"Borrador"},{value:"pending",label:"Solicitada"},{value:"approved",label:"Aprobada"},{value:"enjoyed",label:"Disfrutada"},{value:"rejected",label:"Rechazada"},{value:"cancelled",label:"Cancelada"}];function es({onClose:r,onSuccess:u,balance:C}){const[g,j]=m.useState(1),[c,y]=m.useState({vacation_type:"vacation",start_date:"",end_date:"",days_requested:"",reason:""}),[l,b]=m.useState(null),[D,v]=m.useState(null),[x,d]=m.useState(null),[B,A]=m.useState(!1),[z,_]=m.useState(""),[E,k]=m.useState(null),F=je(),S=Se(),{data:a}=ge({queryKey:["vacation-template"],queryFn:async()=>(await Qe.list({category:"vacation"})).data?.data?.[0]||null}),i=a,o=R({mutationFn:t=>L.create(t),onSuccess:async t=>{const n=t.data?.data,f=t.data?.document;if(b(n),v(f),_(""),n?.id&&n?.pdf_ready)try{const w=await L.downloadDocument(n.id),O=new Blob([w.data],{type:"application/pdf"});d(URL.createObjectURL(O))}catch(w){console.error("Error loading PDF:",w),d(null)}else d(null);j(2)},onError:t=>{const n=t.response?.data;n?.missing_fields&&Array.isArray(n.missing_fields)?(k(n.missing_fields),_(n.message||"Faltan datos requeridos")):Array.isArray(n?.errors)?(_(n.errors.join(", ")),k(null)):(_(n?.error||"Error al crear la solicitud"),k(null))}}),N=R({mutationFn:t=>L.signDocument(t),onSuccess:t=>{v(t.data?.document),b(t.data?.data),re()},onError:t=>{_(t.response?.data?.error||"Error al firmar el documento")}}),te=R({mutationFn:t=>L.submit(t),onSuccess:t=>{b(t.data?.data),j(3),F.invalidateQueries(["vacations"])},onError:t=>{_(t.response?.data?.error||"Error al enviar la solicitud")}}),re=async()=>{if(l?.id&&l?.pdf_ready)try{const t=await L.downloadDocument(l.id),n=new Blob([t.data],{type:"application/pdf"});x&&URL.revokeObjectURL(x),d(URL.createObjectURL(n))}catch(t){console.error("Error reloading PDF:",t)}},be=t=>{const n=t%19,f=Math.floor(t/100),w=t%100,O=Math.floor(f/4),I=f%4,J=Math.floor((f+8)/25),Q=Math.floor((f-J+1)/3),P=(19*n+f-O-Q+15)%30,fe=Math.floor(w/4),ye=w%4,de=(32+2*I+2*fe-P-ye)%7,s=Math.floor((n+11*P+22*de)/451),h=Math.floor((P+de-7*s+114)/31),V=(P+de-7*s+114)%31+1;return new Date(t,h-1,V)},U=t=>{const n=new Date(t),f=n.getDay();return f===0?n.setDate(n.getDate()+1):f!==1&&n.setDate(n.getDate()+(8-f)),n},G=t=>{const n=[],f=be(t);n.push(new Date(t,0,1)),n.push(new Date(t,4,1)),n.push(new Date(t,6,20)),n.push(new Date(t,7,7)),n.push(new Date(t,11,8)),n.push(new Date(t,11,25)),n.push(U(new Date(t,0,6))),n.push(U(new Date(t,2,19))),n.push(U(new Date(t,5,29))),n.push(U(new Date(t,7,15))),n.push(U(new Date(t,9,12))),n.push(U(new Date(t,10,1))),n.push(U(new Date(t,10,11)));const w=new Date(f);w.setDate(f.getDate()-3),n.push(w);const O=new Date(f);O.setDate(f.getDate()-2),n.push(O);const I=new Date(f);I.setDate(f.getDate()+39),n.push(U(I));const J=new Date(f);J.setDate(f.getDate()+60),n.push(U(J));const Q=new Date(f);return Q.setDate(f.getDate()+68),n.push(U(Q)),n},Y=(t,n)=>{const f=t.toISOString().split("T")[0];return n.some(w=>w.toISOString().split("T")[0]===f)},K=(t,n)=>{let f=0;const w=new Date(t),O=new Date(n),I=w.getFullYear(),J=O.getFullYear();let Q=[];for(let P=I;P<=J;P++)Q=Q.concat(G(P));for(;w<=O;){const P=w.getDay();P!==0&&P!==6&&!Y(w,Q)&&f++,w.setDate(w.getDate()+1)}return f};m.useEffect(()=>{if(c.start_date&&c.end_date){const t=new Date(c.start_date+"T00:00:00"),n=new Date(c.end_date+"T00:00:00");if(n>=t){const f=K(t,n);y(w=>({...w,days_requested:f.toString()}))}}},[c.start_date,c.end_date]),m.useEffect(()=>()=>{x&&URL.revokeObjectURL(x)},[x]);const ie=t=>{t.preventDefault(),o.mutate(c)},ue=()=>{_(""),l?.id&&N.mutate(l.id)},W=()=>{_(""),l?.id&&te.mutate(l.id)},ke=()=>{F.invalidateQueries(["vacations"]),u?.(),r()},T=()=>{x&&window.open(x,"_blank")},pe=D?.employee_signed||!1,ce=l?.pdf_ready===!1,Fe=pe||ce;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-center gap-2 mb-6",children:[1,2,3].map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${g>=t?"bg-primary-500 text-white":"bg-gray-200 text-gray-500"}`,children:g>t?e.jsx(Z,{className:"w-5 h-5"}):t}),t<3&&e.jsx("div",{className:`w-12 h-1 mx-1 ${g>t?"bg-primary-500":"bg-gray-200"}`})]},t))}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 px-4 mb-6",children:[e.jsx("span",{className:g>=1?"text-primary-600 font-medium":"",children:"Datos"}),e.jsx("span",{className:g>=2?"text-primary-600 font-medium":"",children:"Firmar"}),e.jsx("span",{className:g>=3?"text-primary-600 font-medium":"",children:"Enviado"})]}),g===1&&e.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[i&&e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg flex items-start gap-3",children:[e.jsx(ee,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:i.name}),e.jsx("p",{className:"text-sm text-blue-700",children:"Se generará el documento oficial para tu firma"}),i.signatories_count>0&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-sm text-blue-600",children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsxs("span",{children:[i.signatories_count," firmantes requeridos"]})]})]})]}),e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg flex items-center justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Días disponibles para solicitar:"}),e.jsx("span",{className:"text-xl font-bold text-green-600",children:Math.floor(C?.available||0)})]}),e.jsx(ae,{label:"Tipo de Solicitud",options:ze,value:c.vacation_type,onChange:t=>y({...c,vacation_type:t.target.value}),required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(le,{label:"Fecha Inicio",type:"date",value:c.start_date,min:new Date().toISOString().split("T")[0],onChange:t=>{y({...c,start_date:t.target.value}),_(""),k(null)},required:!0}),e.jsx(le,{label:"Fecha Fin",type:"date",value:c.end_date,min:c.start_date||new Date().toISOString().split("T")[0],onChange:t=>{y({...c,end_date:t.target.value}),_(""),k(null)},required:!0})]}),e.jsx(le,{label:"Días Solicitados",type:"number",step:"0.5",min:"0.5",value:c.days_requested,onChange:t=>y({...c,days_requested:t.target.value}),required:!0}),parseFloat(c.days_requested)>(C?.available||0)&&e.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-2 text-amber-700",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Los días solicitados exceden tu saldo disponible"})]}),z&&!E&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:z})]}),E&&E.length>0&&e.jsx("div",{className:"p-4 bg-amber-50 border border-amber-300 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-amber-800 mb-2",children:"Faltan datos requeridos para generar la solicitud"}),e.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"Por favor complete los siguientes datos antes de continuar:"}),e.jsx("ul",{className:"text-sm text-amber-700 space-y-1 mb-4",children:E.map((t,n)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full"}),e.jsx("span",{children:t.label||t.field}),t.source==="employee"&&e.jsx("span",{className:"text-xs text-amber-500",children:"(Perfil del empleado)"}),t.source==="organization"&&e.jsx("span",{className:"text-xs text-amber-500",children:"(Configuración de la empresa)"})]},n))}),E.some(t=>t.source==="employee")&&e.jsx(p,{type:"button",variant:"secondary",size:"sm",onClick:()=>S("/profile"),children:"Ir a mi Perfil para completar datos"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo (opcional)"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",rows:3,value:c.reason,onChange:t=>y({...c,reason:t.target.value}),placeholder:"Describe el motivo de tu solicitud..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(p,{type:"button",variant:"secondary",onClick:r,children:"Cancelar"}),e.jsx(p,{type:"submit",loading:o.isPending,children:"Continuar"})]})]}),g===2&&l&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"font-medium text-gray-900",children:["Solicitud ",l.request_number]}),e.jsx(oe,{status:l.status})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Tipo:"}),e.jsx("p",{className:"font-medium",children:ze.find(t=>t.value===l.vacation_type)?.label})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Fechas:"}),e.jsxs("p",{className:"font-medium",children:[new Date(l.start_date).toLocaleDateString("es-ES")," - ",new Date(l.end_date).toLocaleDateString("es-ES")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Días:"}),e.jsx("p",{className:"font-bold text-primary-600",children:l.days_requested})]})]})]}),x?e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-100 px-4 py-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Documento de Solicitud"}),e.jsxs(p,{variant:"ghost",size:"sm",onClick:T,children:[e.jsx(Le,{className:"w-4 h-4"}),"Abrir en nueva pestaña"]})]}),e.jsx("iframe",{src:x,className:"w-full h-[400px] border-0",title:"Vista previa del documento"})]}):l?.pdf_ready===!1?e.jsxs("div",{className:"border rounded-lg p-8 text-center bg-amber-50 border-amber-200",children:[e.jsx($,{className:"w-8 h-8 mx-auto text-amber-500 mb-2"}),e.jsx("p",{className:"text-amber-700 font-medium",children:"El documento está pendiente de generación"}),e.jsx("p",{className:"text-amber-600 text-sm mt-1",children:"El PDF se generará próximamente. Puedes continuar con el proceso."})]}):e.jsxs("div",{className:"border rounded-lg p-8 text-center bg-gray-50",children:[e.jsx(se,{className:"w-8 h-8 animate-spin mx-auto text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Cargando documento..."})]}),e.jsxs("div",{className:"p-4 bg-white border rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"Firmas Requeridas"]}),e.jsx("div",{className:"space-y-3",children:D?.signatures?.map((t,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${t.signed?"bg-green-500 text-white":"bg-gray-300 text-gray-600"}`,children:t.signed?e.jsx(Z,{className:"w-5 h-5"}):n+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.label}),t.signed&&e.jsxs("p",{className:"text-xs text-green-600",children:["Firmado por ",t.signed_by," - ",new Date(t.signed_at).toLocaleString("es-ES")]})]})]}),t.signatory_type_code==="employee"&&!t.signed&&e.jsxs(p,{size:"sm",onClick:ue,loading:N.isPending,children:[e.jsx(ne,{className:"w-4 h-4"}),"Firmar"]}),t.signatory_type_code!=="employee"&&!t.signed&&e.jsx("span",{className:"text-xs text-gray-500 px-2 py-1 bg-gray-200 rounded",children:"Pendiente"})]},n))})]}),z&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:z})]}),ce&&e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg flex items-start gap-3",children:[e.jsx($,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium",children:"Documento pendiente de generación"}),e.jsx("p",{className:"mt-1",children:"Puedes enviar la solicitud ahora. El documento se generará y firmará posteriormente."})]})]}),!ce&&!pe&&e.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg flex items-start gap-3",children:[e.jsx($,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-amber-800",children:[e.jsx("p",{className:"font-medium",children:"Debes firmar el documento antes de enviar"}),e.jsx("p",{className:"mt-1",children:'Haz clic en el botón "Firmar" junto a tu nombre para continuar.'})]})]}),!ce&&pe&&e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg flex items-start gap-3",children:[e.jsx(Z,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"¡Documento firmado!"}),e.jsx("p",{className:"mt-1",children:"Ahora puedes enviar la solicitud para aprobación del supervisor y RRHH."})]})]}),e.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[e.jsx(p,{variant:"secondary",onClick:()=>j(1),children:"Volver"}),e.jsxs(p,{onClick:W,loading:te.isPending,disabled:!Fe,children:[e.jsx(Oe,{className:"w-4 h-4"}),"Enviar Solicitud"]})]})]}),g===3&&l&&e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(Z,{className:"w-8 h-8 text-green-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"¡Solicitud Enviada!"}),e.jsxs("p",{className:"text-gray-600",children:["Tu solicitud ",e.jsx("span",{className:"font-medium",children:l.request_number})," ha sido enviada correctamente."]}),x&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Documento firmado:"}),e.jsxs(p,{variant:"secondary",onClick:T,children:[e.jsx(qe,{className:"w-4 h-4"}),"Ver Documento PDF"]})]}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-left",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Próximos pasos:"}),e.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"Tu supervisor recibirá la solicitud para aprobación y firma"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"Recursos Humanos revisará y firmará la solicitud"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"Recibirás notificación cuando sea aprobada"})]})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx(p,{onClick:ke,children:"Cerrar"})})]})]})}function ss({vacation:r,onSubmit:u,onCancel:C,onDelete:g,onView:j,onDownload:c,onSign:y}){const l={vacation:"Vacaciones",personal:"Día Personal",sick:"Enfermedad",bereavement:"Duelo",unpaid:"Sin Goce"};return e.jsx(q,{className:"hover:shadow-md transition-shadow",children:e.jsxs(M,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary-50 rounded-lg",children:e.jsx(Ee,{className:"w-5 h-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:l[r.vacation_type]||r.vacation_type}),e.jsx("p",{className:"text-sm text-gray-500",children:r.request_number}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[new Date(r.start_date).toLocaleDateString("es-ES")," - ",new Date(r.end_date).toLocaleDateString("es-ES")]}),e.jsxs("p",{className:"text-sm font-medium text-primary-600 mt-1",children:[r.days_requested," días"]})]})]}),e.jsx(oe,{status:r.status})]}),e.jsxs("div",{className:"flex justify-end gap-1 mt-4 pt-4 border-t border-gray-100",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>j(r),title:"Ver detalles",children:e.jsx(we,{className:"w-4 h-4"})}),r.pdf_ready&&e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>c(r.id),title:"Descargar documento",children:e.jsx(qe,{className:"w-4 h-4"})}),r.status==="draft"&&r.needs_employee_signature&&e.jsxs(p,{variant:"secondary",size:"sm",onClick:()=>y(r),title:"Firmar documento",children:[e.jsx(ne,{className:"w-4 h-4"}),"Firmar"]}),r.status==="draft"&&!r.needs_employee_signature&&e.jsx(p,{variant:"primary",size:"sm",onClick:()=>u(r.id),title:"Enviar solicitud",children:e.jsx(Oe,{className:"w-4 h-4"})}),["draft","pending"].includes(r.status)&&e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>C(r.id),title:"Cancelar solicitud",children:e.jsx(Ce,{className:"w-4 h-4"})}),r.can_delete&&e.jsx(p,{variant:"danger",size:"sm",onClick:()=>g(r.id),title:"Eliminar solicitud",children:e.jsx(De,{className:"w-4 h-4"})})]})]})})}function as({vacation:r,onClose:u,onDownload:C,onRefresh:g}){const[j,c]=m.useState(null),[y,l]=m.useState(!1),[b,D]=m.useState(null),[v,x]=m.useState(null),[d,B]=m.useState(""),A=je(),z={vacation:"Vacaciones",personal:"Día Personal",sick:"Enfermedad",bereavement:"Duelo",unpaid:"Sin Goce"},_=async()=>{try{const a=await L.get(r.id);D(a.data?.data),x(a.data?.document)}catch(a){console.error("Error fetching vacation detail:",a)}};m.useEffect(()=>{_()},[r.id]);const E=R({mutationFn:a=>L.signDocument(a),onSuccess:a=>{x(a.data?.document),B(""),A.invalidateQueries(["vacations"]),j&&(URL.revokeObjectURL(j),c(null)),F(),_()},onError:a=>{B(a.response?.data?.error||"Error al firmar el documento")}}),k=()=>{B(""),E.mutate(r.id)};m.useEffect(()=>(r.pdf_ready&&r.id&&F(),()=>{j&&URL.revokeObjectURL(j)}),[r.id,r.pdf_ready]);const F=async()=>{l(!0);try{const a=await L.downloadDocument(r.id),i=new Blob([a.data],{type:"application/pdf"});c(URL.createObjectURL(i))}catch(a){console.error("Error loading PDF:",a)}finally{l(!1)}},S=()=>{j&&window.open(j,"_blank")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Número:"}),e.jsx("p",{className:"font-medium",children:r.request_number})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Estado:"}),e.jsx("div",{className:"mt-1",children:e.jsx(oe,{status:r.status})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Tipo:"}),e.jsx("p",{className:"font-medium",children:z[r.vacation_type]||r.vacation_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Días:"}),e.jsx("p",{className:"font-bold text-primary-600",children:r.days_requested})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Fechas:"}),e.jsxs("p",{className:"font-medium",children:[new Date(r.start_date).toLocaleDateString("es-ES")," - ",new Date(r.end_date).toLocaleDateString("es-ES")]})]})]}),r.reason&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500 block mb-1",children:"Motivo:"}),e.jsx("p",{className:"text-gray-700 bg-gray-50 p-3 rounded-lg",children:r.reason})]}),r.decision_reason&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500 block mb-1",children:"Comentario del aprobador:"}),e.jsx("p",{className:"text-gray-700 bg-gray-50 p-3 rounded-lg",children:r.decision_reason})]}),r.has_document&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-primary-600"}),"Documento de Solicitud"]}),y?e.jsxs("div",{className:"border rounded-lg p-8 text-center bg-gray-50",children:[e.jsx(se,{className:"w-8 h-8 animate-spin mx-auto text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Cargando documento..."})]}):j?e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-100 px-4 py-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Vista Previa del Documento"}),e.jsxs(p,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(Le,{className:"w-4 h-4"}),"Abrir en nueva pestaña"]})]}),e.jsx("iframe",{src:j,className:"w-full h-[350px] border-0",title:"Vista previa del documento"})]}):r.pdf_ready===!1?e.jsxs("div",{className:"border rounded-lg p-6 text-center bg-amber-50 border-amber-200",children:[e.jsx($,{className:"w-8 h-8 mx-auto text-amber-500 mb-2"}),e.jsx("p",{className:"text-amber-700 font-medium",children:"Documento pendiente de generación"}),e.jsx("p",{className:"text-amber-600 text-sm mt-1",children:"El PDF se generará próximamente"})]}):e.jsxs("div",{className:"border rounded-lg p-6 text-center bg-gray-50",children:[e.jsx(ee,{className:"w-8 h-8 mx-auto text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-500",children:"No se pudo cargar el documento"})]}),v?.signatures&&v.signatures.length>0&&e.jsxs("div",{className:"mt-4 p-4 bg-white border rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"Firmas del Documento"]}),e.jsx("div",{className:"space-y-3",children:v.signatures.map((a,i)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${a.signed?"bg-green-500 text-white":"bg-gray-300 text-gray-600"}`,children:a.signed?e.jsx(Z,{className:"w-5 h-5"}):a.position||i+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.label}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.signatory_type_code==="employee"&&"Empleado Solicitante",a.signatory_type_code==="supervisor"&&"Supervisor Directo",a.signatory_type_code==="hr"&&"Recursos Humanos"]}),a.signed&&e.jsxs("p",{className:"text-xs text-green-600 mt-0.5",children:["Firmado por ",a.signed_by," - ",new Date(a.signed_at).toLocaleString("es-ES")]})]})]}),a.signatory_type_code==="employee"&&!a.signed&&e.jsxs(p,{size:"sm",onClick:k,loading:E.isPending,children:[e.jsx(ne,{className:"w-4 h-4"}),"Firmar"]}),a.signatory_type_code!=="employee"&&!a.signed&&e.jsx("span",{className:"text-xs text-amber-600 px-2 py-1 bg-amber-100 rounded",children:"Pendiente"})]},i))}),d&&e.jsxs("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:d})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[r.pdf_ready&&e.jsxs(p,{variant:"secondary",onClick:()=>C(r.id),children:[e.jsx(qe,{className:"w-4 h-4"}),"Descargar PDF"]}),e.jsx(p,{onClick:u,children:"Cerrar"})]})]})}function ts(){const[r,u]=m.useState(!1),[C,g]=m.useState(!1),[j,c]=m.useState(null),[y,l]=m.useState(""),b=je(),D=Ie(),v=Se();m.useEffect(()=>{D.state?.openNew&&(u(!0),v(D.pathname,{replace:!0,state:{}}))},[D.state,D.pathname,v]);const{data:x,isLoading:d}=ge({queryKey:["vacations",{status:y}],queryFn:()=>L.list({status:y||void 0})}),B=R({mutationFn:o=>L.submit(o),onSuccess:()=>{b.invalidateQueries(["vacations"])}}),A=R({mutationFn:o=>L.cancel(o),onSuccess:()=>{b.invalidateQueries(["vacations"])}}),z=R({mutationFn:o=>L.delete(o),onSuccess:()=>{b.invalidateQueries(["vacations"])},onError:o=>{alert(o.response?.data?.error||"Error al eliminar la solicitud")}}),_=R({mutationFn:o=>L.signDocument(o),onSuccess:()=>{b.invalidateQueries(["vacations"]),alert("Documento firmado exitosamente. Ahora puedes enviar la solicitud.")},onError:o=>{const N=o.response?.data?.error||"Error al firmar el documento";o.response?.data?.action_required?.type==="configure_signature"?window.confirm("No tienes firma digital configurada. ¿Deseas configurarla ahora?")&&v("/profile"):alert(N)}}),E=o=>{window.confirm("¿Estás seguro de que deseas eliminar esta solicitud? Esta acción no se puede deshacer.")&&z.mutate(o)},k=o=>{_.mutate(o.id)},F=x?.data?.data||[],S=x?.data?.meta?.vacation_balance||{},a=o=>{c(o),g(!0)},i=async o=>{try{const N=await L.downloadDocument(o),te=new Blob([N.data],{type:"application/pdf"}),re=window.URL.createObjectURL(te);window.open(re,"_blank")}catch(N){console.error("Error downloading document:",N),alert("Error al descargar el documento")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mis Vacaciones"}),e.jsx("p",{className:"text-gray-500",children:"Gestiona tus solicitudes de vacaciones"})]}),e.jsxs(p,{onClick:()=>u(!0),children:[e.jsx(me,{className:"w-4 h-4"}),"Nueva Solicitud"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(q,{className:"bg-blue-50 border-blue-200",children:e.jsx(M,{className:"p-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(Ge,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:Math.floor((S.accrued||0)-(S.enjoyed||0))}),e.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Días por Contrato"}),e.jsx("p",{className:"text-xs text-blue-500",children:"Acumulados - Disfrutados"})]})]})})}),e.jsx(q,{className:"bg-amber-50 border-amber-200",children:e.jsx(M,{className:"p-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-amber-100 rounded-xl",children:e.jsx(He,{className:"w-6 h-6 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-amber-600",children:Math.floor(S.scheduled||0)}),e.jsx("p",{className:"text-sm text-amber-700 font-medium",children:"Días Programados"}),e.jsx("p",{className:"text-xs text-amber-500",children:"Aprobados sin disfrutar"})]})]})})}),e.jsx(q,{className:"bg-green-50 border-green-300 ring-2 ring-green-200",children:e.jsx(M,{className:"p-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(me,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-green-600",children:Math.floor(S.available||0)}),e.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Días Vacaciones"}),e.jsx("p",{className:"text-xs text-green-500",children:"Para solicitar"})]})]})})})]}),e.jsx(q,{children:e.jsx(M,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ae,{className:"w-4 h-4 text-gray-400"}),e.jsx(ae,{options:Ze,value:y,onChange:o=>l(o.target.value),className:"w-48"})]})})}),d?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map(o=>e.jsx(q,{className:"animate-pulse",children:e.jsx(M,{className:"p-4",children:e.jsx("div",{className:"h-24 bg-gray-100 rounded"})})},o))}):F.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:F.map(o=>e.jsx(ss,{vacation:o,onSubmit:N=>B.mutate(N),onCancel:N=>A.mutate(N),onDelete:E,onView:a,onDownload:i,onSign:k},o.id))}):e.jsx(q,{children:e.jsxs(M,{className:"py-12 text-center",children:[e.jsx(Ee,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes solicitudes de vacaciones"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Crea tu primera solicitud de vacaciones"}),e.jsxs(p,{onClick:()=>u(!0),children:[e.jsx(me,{className:"w-4 h-4"}),"Nueva Solicitud"]})]})}),e.jsx(X,{isOpen:r,onClose:()=>u(!1),title:"Nueva Solicitud de Vacaciones",size:"xl",children:e.jsx(es,{onClose:()=>u(!1),onSuccess:()=>b.invalidateQueries(["vacations"]),balance:S})}),e.jsx(X,{isOpen:C,onClose:()=>g(!1),title:"Detalle de Solicitud",size:"xl",children:j&&e.jsx(as,{vacation:j,onClose:()=>g(!1),onDownload:i})})]})}const rs=[{value:"employment",label:"Certificación Laboral Básica"},{value:"salary",label:"Certificación con Salario"},{value:"position",label:"Certificación de Cargo"},{value:"full",label:"Certificación Completa"},{value:"custom",label:"Certificación Personalizada"}],ls=[{value:"bank",label:"Entidad Bancaria / Crédito"},{value:"visa",label:"Trámite de Visa"},{value:"rental",label:"Arrendamiento / Inmobiliaria"},{value:"government",label:"Trámite Gubernamental"},{value:"legal",label:"Proceso Legal"},{value:"other",label:"Otro"}],ns=[{value:"es",label:"Español"},{value:"en",label:"Inglés"}],is=[{value:"",label:"Todos los estados"},{value:"pending",label:"Pendiente"},{value:"processing",label:"En Proceso"},{value:"completed",label:"Completado"},{value:"rejected",label:"Rechazado"},{value:"cancelled",label:"Cancelado"}],_e={employment:"Certificación Laboral",salary:"Con Salario",position:"Certificación de Cargo",full:"Certificación Completa",custom:"Personalizada"},Ue={bank:"Entidad Bancaria",visa:"Trámite de Visa",rental:"Arrendamiento",government:"Trámite Gubernamental",legal:"Proceso Legal",other:"Otro"},Pe={employment:1,salary:2,position:1,full:3,custom:3};function cs({onSubmit:r,onCancel:u,loading:C,initialType:g,availableTypes:j}){const c=j?.length>0?j:rs,y=g&&c.find(x=>x.value===g)?g:c[0]?.value||"employment",[l,b]=m.useState({certification_type:y,purpose:"bank",purpose_details:"",language:"es",addressee:"",special_instructions:""});m.useEffect(()=>{g&&c.find(x=>x.value===g)&&b(x=>({...x,certification_type:g}))},[g,c]);const D=x=>{x.preventDefault(),r(l)},v=l.certification_type;return e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsx(ae,{label:"Tipo de Certificación",options:c,value:l.certification_type,onChange:x=>b({...l,certification_type:x.target.value}),required:!0}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-700",children:[e.jsx(xe,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm font-medium",children:["Tiempo estimado: ",Pe[v]," día",Pe[v]>1?"s":""," hábil",Pe[v]>1?"es":""]})]})}),e.jsx(ae,{label:"Propósito",options:ls,value:l.purpose,onChange:x=>b({...l,purpose:x.target.value}),required:!0}),l.purpose==="other"&&e.jsx(le,{label:"Especifique el propósito",value:l.purpose_details,onChange:x=>b({...l,purpose_details:x.target.value}),placeholder:"Describa el propósito de la certificación...",required:!0}),e.jsx(ae,{label:"Idioma",options:ns,value:l.language,onChange:x=>b({...l,language:x.target.value})}),e.jsx(le,{label:"Dirigido a (opcional)",value:l.addressee,onChange:x=>b({...l,addressee:x.target.value}),placeholder:"Ej: A quien corresponda, Banco XYZ, Embajada..."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instrucciones especiales (opcional)"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",rows:3,value:l.special_instructions,onChange:x=>b({...l,special_instructions:x.target.value}),placeholder:"Información adicional o requisitos especiales..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(p,{type:"button",variant:"secondary",onClick:u,children:"Cancelar"}),e.jsx(p,{type:"submit",loading:C,children:"Solicitar Certificación"})]})]})}const ds={pending:e.jsx(xe,{className:"w-4 h-4 text-yellow-500"}),processing:e.jsx(xe,{className:"w-4 h-4 text-blue-500 animate-pulse"}),completed:e.jsx(Z,{className:"w-4 h-4 text-green-500"}),rejected:e.jsx($,{className:"w-4 h-4 text-red-500"}),cancelled:e.jsx(Ce,{className:"w-4 h-4 text-gray-400"})};function os({onClose:r}){const[u,C]=m.useState([]),[g,j]=m.useState(!1),[c,y]=m.useState(null),[l,b]=m.useState({code:"",label:"",description:"",template_id:""}),D=je(),{data:v,isLoading:x}=ge({queryKey:["admin-certification-templates"],queryFn:()=>ve.list({category:"certification",status:"active"})}),d=v?.data?.data||[];m.useEffect(()=>{if(d.length>0){const a=d.filter(i=>i.certification_type).map(i=>({code:i.certification_type,label:_e[i.certification_type]||i.certification_type,description:"",template_id:i.id,template_name:i.name,variables:i.variables||[]}));C(a)}},[d]);const B=a=>d.filter(i=>!i.certification_type||i.id===a),A=d.filter(a=>!a.certification_type),z=()=>{if(!l.code||!l.template_id){alert("Debe ingresar un código y seleccionar un template");return}if(u.find(i=>i.code===l.code)){alert("Ya existe un tipo con ese código");return}const a=d.find(i=>i.id===l.template_id);C([...u,{...l,template_name:a?.name,variables:a?.variables||[]}]),b({code:"",label:"",description:"",template_id:""})},_=a=>{C(u.filter(i=>i.code!==a)),c===a&&y(null)},E=a=>{y(c===a?null:a)},k=(a,i)=>{const o=d.find(N=>N.id===i);C(u.map(N=>N.code===a?{...N,template_id:i,template_name:o?.name,variables:o?.variables||[]}:N))},F=(a,i)=>{C(u.map(o=>o.code===a?{...o,label:i}:o))},S=async()=>{j(!0);try{for(const a of d){const i=u.find(o=>o.template_id===a.id);a.certification_type&&!i?await ve.update(a.id,{template:{certification_type:null}}):a.certification_type&&i&&a.certification_type!==i.code&&await ve.update(a.id,{template:{certification_type:i.code}})}for(const a of u)a.template_id&&await ve.update(a.template_id,{template:{certification_type:a.code}});D.invalidateQueries(["certification-available-types"]),D.invalidateQueries(["admin-certification-templates"]),alert("Configuración guardada exitosamente"),r()}catch(a){console.error("Error saving certification types:",a),alert("Error al guardar: "+(a.response?.data?.error||a.message))}finally{j(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Configure los tipos de certificación disponibles. Cada tipo debe tener un template asociado."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Tipos Configurados"}),u.length===0?e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No hay tipos configurados"}):e.jsx("div",{className:"space-y-2",children:u.map(a=>e.jsx("div",{className:`p-3 border rounded-lg ${c===a.code?"bg-blue-50 border-blue-300":"bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm font-mono bg-gray-200 px-2 py-0.5 rounded",children:a.code}),c===a.code?e.jsx("input",{type:"text",value:a.label,onChange:i=>F(a.code,i.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Etiqueta"}):e.jsx("span",{className:"font-medium",children:a.label})]}),c===a.code?e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Template asociado:"}),e.jsx("select",{value:a.template_id,onChange:i=>k(a.code,i.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:B(a.template_id).map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))})]}):e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-gray-600",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{children:a.template_name})]}),a.variables?.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Variables requeridas:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.variables.slice(0,5).map((i,o)=>e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:i},o)),a.variables.length>5&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",a.variables.length-5," más"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>E(a.code),className:`p-1 rounded ${c===a.code?"text-blue-600 bg-blue-100":"text-gray-400 hover:text-blue-600 hover:bg-blue-50"}`,title:c===a.code?"Cerrar edición":"Editar",children:e.jsx(Ve,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_(a.code),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",title:"Eliminar",children:e.jsx(De,{className:"w-4 h-4"})})]})]})},a.code))})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Agregar Nuevo Tipo"}),A.length===0&&d.length>0?e.jsx("p",{className:"text-sm text-amber-600",children:"Todos los templates de certificación ya tienen un tipo asignado. Para agregar más tipos, primero suba nuevos templates de certificación."}):x?e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(se,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Cargando templates..."})]}):d.length===0?e.jsx("p",{className:"text-sm text-amber-600",children:'No hay templates de certificación disponibles. Primero debe subir templates con categoría "certification" desde Administración → Templates.'}):e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(le,{label:"Código",value:l.code,onChange:a=>b({...l,code:a.target.value.toLowerCase().replace(/\s/g,"_")}),placeholder:"ej: employment, salary"}),e.jsx(le,{label:"Etiqueta",value:l.label,onChange:a=>b({...l,label:a.target.value}),placeholder:"ej: Certificación Laboral"}),e.jsx("div",{className:"col-span-2",children:e.jsx(ae,{label:"Template Asociado",options:[{value:"",label:"Seleccione un template..."},...A.map(a=>({value:a.id,label:a.name}))],value:l.template_id,onChange:a=>b({...l,template_id:a.target.value})})}),e.jsx("div",{className:"col-span-2",children:e.jsxs(p,{type:"button",variant:"secondary",onClick:z,disabled:!l.code||!l.template_id,children:[e.jsx(me,{className:"w-4 h-4"}),"Agregar Tipo"]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(p,{variant:"ghost",onClick:r,children:"Cancelar"}),e.jsxs(p,{onClick:S,loading:g,children:[e.jsx(Je,{className:"w-4 h-4"}),"Guardar Configuración"]})]})]})}function ms(){const[r,u]=m.useState(!1),[C,g]=m.useState(!1),[j,c]=m.useState(!1),[y,l]=m.useState(!1),[b,D]=m.useState(null),[v,x]=m.useState(null),[d,B]=m.useState(null),[A,z]=m.useState(""),[_,E]=m.useState(""),[k,F]=m.useState(null),[S,a]=m.useState(null),[i,o]=m.useState(null),[N,te]=m.useState(null),[re,be]=m.useState(null),[U,G]=m.useState(null),Y=je(),K=Se(),ie=Ie(),{isHR:ue,isAdmin:W}=$e();m.useEffect(()=>{ie.state?.openNew&&(u(!0),K(ie.pathname,{replace:!0,state:{}}))},[ie.state,ie.pathname,K]);const{data:ke}=ge({queryKey:["certification-available-types"],queryFn:()=>H.getAvailableTypes(),staleTime:300*1e3}),T=ke?.data?.data||[],pe=[{value:"",label:"Todos los tipos"},...T.map(s=>({value:s.value,label:s.label}))],{data:ce,isLoading:Fe}=ge({queryKey:["certifications",{status:A,type:_}],queryFn:()=>H.list({status:A||void 0,type:_||void 0})}),t=R({mutationFn:s=>H.create(s),onSuccess:()=>{Y.invalidateQueries(["certifications"]),u(!1)}}),n=R({mutationFn:s=>H.cancel(s),onSuccess:()=>{Y.invalidateQueries(["certifications"])}}),f=R({mutationFn:s=>H.generateDocument(s),onSuccess:()=>{Y.invalidateQueries(["certifications"]),F(null)},onError:s=>{console.error("Error generating document:",s),F(null);const h=s.response?.data;h?.error_type==="missing_variables"?(D({message:h.error,missingData:h.missing_data,actions:h.action_required||[]}),c(!0)):alert(h?.error||"Error al generar documento")}}),w=R({mutationFn:s=>H.delete(s),onSuccess:()=>{Y.invalidateQueries(["certifications"]),x(null)},onError:s=>{console.error("Error deleting certification:",s),alert(s.response?.data?.error||"Error al eliminar certificación")}}),O=R({mutationFn:s=>H.signDocument(s),onSuccess:s=>{Y.invalidateQueries(["certifications"]),o(null);const h=s.data.document;h.all_signed?alert("Documento firmado y completado exitosamente"):alert(`Documento firmado. Firmas pendientes: ${h.pending_signatures.join(", ")}`)},onError:s=>{console.error("Error signing document:",s),o(null);const h=s.response?.data;h?.action_required?.type==="configure_signature"?confirm("No tienes firma digital configurada. ¿Deseas configurarla ahora?")&&K("/profile"):alert(h?.error||"Error al firmar documento")}}),I=ce?.data?.data||[],J=s=>{B(s),g(!0)},Q=async s=>{F(s),f.mutate(s)},P=async s=>{if(s.response?.data instanceof Blob)try{const h=await s.response.data.text();return JSON.parse(h)}catch{return null}return s.response?.data},fe=async s=>{try{a(s.id);const h=await H.downloadDocument(s.id),V=new Blob([h.data],{type:"application/pdf"}),Ne=URL.createObjectURL(V),he=document.createElement("a");he.href=Ne,he.download=`${s.request_number}.pdf`,document.body.appendChild(he),he.click(),document.body.removeChild(he),URL.revokeObjectURL(Ne)}catch(h){console.error("Error downloading document:",h);const V=await P(h);alert(V?.error||V?.message||"Error al descargar documento")}finally{a(null)}},ye=async s=>{try{be(s.id);const h=await H.downloadDocument(s.id),V=new Blob([h.data],{type:"application/pdf"}),Ne=URL.createObjectURL(V);te(Ne)}catch(h){console.error("Error previewing document:",h);const V=await P(h);alert(V?.error||V?.message||"Error al previsualizar documento")}finally{be(null)}},de=()=>{N&&URL.revokeObjectURL(N),te(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Certificaciones"}),e.jsx("p",{className:"text-gray-500",children:"Solicita certificaciones laborales para distintos trámites"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[W&&e.jsxs(p,{variant:"secondary",onClick:()=>l(!0),title:"Configurar tipos de certificación",children:[e.jsx(Ve,{className:"w-4 h-4"}),"Configurar Tipos"]}),e.jsxs(p,{onClick:()=>u(!0),disabled:T.length===0,title:T.length===0?"No hay tipos de certificación disponibles":"",children:[e.jsx(me,{className:"w-4 h-4"}),"Nueva Solicitud"]})]})]}),e.jsx(q,{children:e.jsx(M,{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ae,{className:"w-4 h-4 text-gray-400"}),e.jsx(ae,{options:is,value:A,onChange:s=>z(s.target.value),className:"w-48"}),e.jsx(ae,{options:pe,value:_,onChange:s=>E(s.target.value),className:"w-56"})]})})}),T.length>0?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[T.find(s=>s.value==="employment")&&e.jsx(q,{className:"bg-blue-50 border-blue-200 cursor-pointer hover:shadow-md hover:border-blue-300 transition-all",onClick:()=>{G("employment"),u(!0)},children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Certificación Laboral"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Confirma tu vínculo laboral actual"})]})]})})}),T.find(s=>s.value==="salary")&&e.jsx(q,{className:"bg-green-50 border-green-200 cursor-pointer hover:shadow-md hover:border-green-300 transition-all",onClick:()=>{G("salary"),u(!0)},children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"Con Información Salarial"}),e.jsx("p",{className:"text-sm text-green-700",children:"Incluye detalles de tu compensación"})]})]})})}),T.find(s=>s.value==="full")&&e.jsx(q,{className:"bg-purple-50 border-purple-200 cursor-pointer hover:shadow-md hover:border-purple-300 transition-all",onClick:()=>{G("full"),u(!0)},children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-purple-900",children:"Certificación Completa"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Incluye toda tu información laboral"})]})]})})}),T.find(s=>s.value==="position")&&e.jsx(q,{className:"bg-amber-50 border-amber-200 cursor-pointer hover:shadow-md hover:border-amber-300 transition-all",onClick:()=>{G("position"),u(!0)},children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"w-8 h-8 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-900",children:"Certificación de Cargo"}),e.jsx("p",{className:"text-sm text-amber-700",children:"Detalla cargo y responsabilidades"})]})]})})}),T.find(s=>s.value==="custom")&&e.jsx(q,{className:"bg-gray-50 border-gray-200 cursor-pointer hover:shadow-md hover:border-gray-300 transition-all",onClick:()=>{G("custom"),u(!0)},children:e.jsx(M,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"w-8 h-8 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Certificación Personalizada"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Contenido según necesidad"})]})]})})})]}):e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"w-6 h-6 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-900",children:"No hay tipos de certificación disponibles"}),e.jsx("p",{className:"text-sm text-amber-700",children:"Contacta al administrador para configurar los templates de certificación."})]})]})}),e.jsxs(q,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-fixed",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-[15%] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Número"}),e.jsx("th",{className:"w-[18%] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"w-[17%] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Propósito"}),e.jsx("th",{className:"w-[12%] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"w-[10%] px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Días"}),e.jsx("th",{className:"w-[13%] px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Fecha"}),e.jsx("th",{className:"w-[15%] px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:Fe?[...Array(3)].map((s,h)=>e.jsxs("tr",{className:"animate-pulse",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-28"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-8 mx-auto"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-16 mx-auto"})})]},h)):I.length>0?I.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("code",{className:"text-sm font-mono text-primary-600 bg-primary-50 px-2 py-0.5 rounded",children:s.request_number})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:_e[s.certification_type]||s.certification_type})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-sm text-gray-600 truncate block",children:Ue[s.purpose]||s.purpose})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[ds[s.status],e.jsx(oe,{status:s.status})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:"text-sm text-gray-600",children:s.estimated_days})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[e.jsx(Ee,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString("es-ES",{day:"2-digit",month:"short"})})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("button",{onClick:()=>J(s),className:"p-1.5 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded transition-colors",title:"Ver detalle",children:e.jsx(we,{className:"w-4 h-4"})}),(ue||W)&&s.status==="pending"&&!s.document_uuid&&e.jsx("button",{onClick:()=>Q(s.id),disabled:k===s.id,className:"p-1.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors disabled:opacity-50",title:"Generar documento",children:k===s.id?e.jsx(se,{className:"w-4 h-4 animate-spin"}):e.jsx(Ke,{className:"w-4 h-4"})}),s.document_uuid&&s.document_info?.can_download&&e.jsx("button",{onClick:()=>ye(s),disabled:re===s.id,className:"p-1.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors disabled:opacity-50",title:"Previsualizar",children:re===s.id?e.jsx(se,{className:"w-4 h-4 animate-spin"}):e.jsx(we,{className:"w-4 h-4"})}),s.document_uuid&&s.document_info?.can_download&&e.jsx("button",{onClick:()=>fe(s),disabled:S===s.id,className:"p-1.5 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded transition-colors disabled:opacity-50",title:"Descargar",children:S===s.id?e.jsx(se,{className:"w-4 h-4 animate-spin"}):e.jsx(Re,{className:"w-4 h-4"})}),s.document_uuid&&s.document_info?.pending_signatures?.length>0&&(ue||W)&&e.jsx("button",{onClick:()=>{o(s.id),O.mutate(s.id)},disabled:i===s.id,className:"p-1.5 text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded transition-colors disabled:opacity-50",title:`Firmar documento (Pendiente: ${s.document_info?.pending_signatures?.join(", ")})`,children:i===s.id?e.jsx(se,{className:"w-4 h-4 animate-spin"}):e.jsx(ne,{className:"w-4 h-4"})}),s.document_uuid&&!s.document_info?.pdf_ready&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs text-blue-700 bg-blue-50 rounded",title:"El PDF se está generando",children:[e.jsx(se,{className:"w-3 h-3 mr-1 animate-spin"}),"PDF pendiente"]}),s.document_uuid&&s.document_info?.pdf_ready&&!s.document_info?.can_download&&!(ue||W)&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs text-amber-700 bg-amber-50 rounded",title:`Pendiente: ${s.document_info?.pending_signatures?.join(", ")}`,children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),"Firma pendiente"]}),["pending","processing"].includes(s.status)&&!W&&e.jsx("button",{onClick:()=>n.mutate(s.id),className:"p-1.5 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Cancelar",children:e.jsx(Ce,{className:"w-4 h-4"})}),W&&e.jsx("button",{onClick:()=>x(s),className:"p-1.5 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Eliminar",children:e.jsx(De,{className:"w-4 h-4"})})]})})]},s.id)):e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-4 py-12 text-center",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),e.jsx("h3",{className:"text-base font-medium text-gray-900 mb-1",children:"No tienes solicitudes de certificaciones"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Solicita una certificación laboral para tus trámites"}),e.jsxs(p,{size:"sm",onClick:()=>u(!0),disabled:T.length===0,children:[e.jsx(me,{className:"w-4 h-4"}),"Nueva Solicitud"]})]})})})]})}),I.length>0&&e.jsx("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50",children:e.jsxs("p",{className:"text-sm text-gray-500",children:[I.length," solicitud",I.length!==1?"es":""]})})]}),e.jsx(X,{isOpen:r,onClose:()=>{u(!1),G(null)},title:"Nueva Solicitud de Certificación",size:"lg",children:e.jsx(cs,{onSubmit:s=>t.mutate(s),onCancel:()=>{u(!1),G(null)},loading:t.isPending,initialType:U,availableTypes:T})}),e.jsx(X,{isOpen:C,onClose:()=>g(!1),title:"Detalle de Certificación",size:"md",children:d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Número:"}),e.jsx("span",{className:"font-medium",children:d.request_number})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Estado:"}),e.jsx(oe,{status:d.status})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Tipo:"}),e.jsx("span",{children:_e[d.certification_type]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Propósito:"}),e.jsx("span",{children:Ue[d.purpose]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Tiempo estimado:"}),e.jsxs("span",{children:[d.estimated_days," día",d.estimated_days>1?"s":""," hábil",d.estimated_days>1?"es":""]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Fecha solicitud:"}),e.jsx("span",{children:new Date(d.created_at).toLocaleDateString("es-ES")})]}),d.language&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Idioma:"}),e.jsx("span",{children:d.language==="es"?"Español":"Inglés"})]}),d.status==="completed"&&d.completed_at&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Fecha completado:"}),e.jsx("span",{className:"text-green-600 font-medium",children:new Date(d.completed_at).toLocaleDateString("es-ES")})]}),d.status==="rejected"&&d.rejection_reason&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-red-800 mb-1",children:"Motivo de rechazo:"}),e.jsx("p",{className:"text-red-700",children:d.rejection_reason})]}),d.processed_by&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Procesado por:"}),e.jsx("p",{className:"text-gray-600",children:d.processed_by.name})]}),d.document_uuid&&d.document_info?.can_download&&e.jsxs("div",{className:"pt-4 border-t space-y-2",children:[e.jsxs(p,{className:"w-full",variant:"primary",onClick:()=>ye(d),loading:re===d.id,children:[e.jsx(we,{className:"w-4 h-4"}),"Previsualizar Documento"]}),e.jsxs(p,{className:"w-full",variant:"secondary",onClick:()=>fe(d),loading:S===d.id,children:[e.jsx(Re,{className:"w-4 h-4"}),"Descargar Certificación"]})]})]})}),e.jsx(X,{isOpen:j,onClose:()=>c(!1),title:"No se puede generar el documento",size:"md",children:b&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(Te,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Información faltante"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:b.message})]})]}),b.missingData?.by_source?.employee?.length>0&&e.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-amber-800 mb-2",children:"Datos del empleado requeridos:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-amber-700 space-y-1",children:b.missingData.by_source.employee.map((s,h)=>e.jsx("li",{children:s.field_label||s.field},h))})]}),b.missingData?.by_source?.organization?.length>0&&e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"Datos de la organización requeridos:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-blue-700 space-y-1",children:b.missingData.by_source.organization.map((s,h)=>e.jsx("li",{children:s.field_label||s.field},h))})]}),e.jsxs("div",{className:"flex flex-col gap-2 pt-4 border-t",children:[b.actions?.map((s,h)=>e.jsxs(p,{variant:h===0?"primary":"secondary",className:"w-full justify-center",onClick:()=>{c(!1),s.type==="edit_employee"&&s.employee_id?K(`/hr/employees?edit=${s.employee_id}`):s.type==="edit_organization"?K("/admin/organization"):s.type==="configure_mappings"&&K("/admin/variable-mappings")},children:[e.jsx(Le,{className:"w-4 h-4"}),s.label,s.employee_name&&` (${s.employee_name})`]},h)),e.jsx(p,{variant:"ghost",className:"w-full justify-center",onClick:()=>c(!1),children:"Cerrar"})]})]})}),e.jsx(X,{isOpen:!!v,onClose:()=>x(null),title:"Eliminar Certificación",size:"sm",children:v&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(Te,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"¿Eliminar esta certificación?"}),e.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["Esta acción no se puede deshacer. Se eliminará permanentemente la solicitud"," ",e.jsx("strong",{children:v.request_number}),"."]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Tipo:"}),e.jsx("span",{className:"font-medium",children:_e[v.certification_type]})]}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-gray-500",children:"Estado:"}),e.jsx(oe,{status:v.status})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(p,{variant:"ghost",className:"flex-1",onClick:()=>x(null),children:"Cancelar"}),e.jsxs(p,{variant:"danger",className:"flex-1",loading:w.isPending,onClick:()=>w.mutate(v.id),children:[e.jsx(De,{className:"w-4 h-4"}),"Eliminar"]})]})]})}),e.jsx(X,{isOpen:!!N,onClose:de,title:"Previsualización de Documento",size:"full",children:e.jsxs("div",{className:"flex flex-col h-[80vh]",children:[N&&e.jsx("iframe",{src:N,className:"w-full flex-1 border rounded-lg bg-gray-100",title:"Vista previa del documento"}),e.jsx("div",{className:"flex justify-end gap-3 pt-4 border-t mt-4",children:e.jsxs(p,{variant:"secondary",onClick:de,children:[e.jsx(Ce,{className:"w-4 h-4"}),"Cerrar"]})})]})}),e.jsx(X,{isOpen:y,onClose:()=>l(!1),title:"Configurar Tipos de Certificación",size:"lg",children:e.jsx(os,{onClose:()=>{l(!1),Y.invalidateQueries(["certification-available-types"])}})})]})}const xs=[{id:"vacations",name:"Vacaciones",icon:Ee,path:"/hr/my-requests/vacations"},{id:"certifications",name:"Certificaciones",icon:Xe,path:"/hr/my-requests/certifications"}];function Cs(){const{tab:r}=Be(),u=Se();if(!r)return e.jsx(Me,{to:"/hr/my-requests/vacations",replace:!0});if(!["vacations","certifications"].includes(r))return e.jsx(Me,{to:"/hr/my-requests/vacations",replace:!0});const g=r;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:xs.map(j=>{const c=j.icon,y=g===j.id;return e.jsxs("button",{onClick:()=>u(j.path),className:`
                  group inline-flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm
                  ${y?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[e.jsx(c,{className:`w-5 h-5 ${y?"text-primary-500":"text-gray-400 group-hover:text-gray-500"}`}),j.name]},j.id)})})}),e.jsxs("div",{children:[g==="vacations"&&e.jsx(ts,{}),g==="certifications"&&e.jsx(ms,{})]})]})}export{Cs as default};
