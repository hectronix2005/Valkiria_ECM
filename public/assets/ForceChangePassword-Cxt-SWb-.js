import{j as e}from"./vendor-query-BtlmzfbD.js";import{r as s,a as k}from"./vendor-router-CyR0tpch.js";import{u as L,a as q}from"./index-D3UX-zL7.js";import{B as h}from"./Button-Cc42oWsS.js";import{I as d}from"./Input-DPOK3q6H.js";import{n as I,o as _,l as A,E as p,m as b}from"./vendor-icons-YtD_Ipmm.js";import"./vendor-react-Cgg2GOmP.js";import"./vendor-axios-B9ygI19o.js";function K(){const[o,f]=s.useState(""),[n,g]=s.useState(""),[i,j]=s.useState(""),[l,v]=s.useState(!1),[c,w]=s.useState(!1),[m,r]=s.useState(""),[N,u]=s.useState(!1),{user:C,updateUser:y,logout:S}=L(),x=k(),E=async a=>{if(a.preventDefault(),r(""),!o.trim()){r("El correo corporativo es requerido");return}if(!o.includes("@")){r("Ingresa un correo electronico valido");return}if(n!==i){r("Las contraseñas no coinciden");return}if(n.length<8){r("La contraseña debe tener al menos 8 caracteres");return}u(!0);try{const t=await q.forceChangePassword({corporate_email:o,new_password:n,new_password_confirmation:i});t.data.token&&localStorage.setItem("token",t.data.token),t.data.data&&y(t.data.data),x("/",{replace:!0})}catch(t){r(t.response?.data?.error||"Error al cambiar la contraseña")}finally{u(!1)}},P=()=>{S(),x("/login",{replace:!0})};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-amber-500 to-amber-700 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-2xl shadow-lg mb-4",children:e.jsx(I,{className:"w-8 h-8 text-amber-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Cambio de Contraseña"}),e.jsx("p",{className:"text-amber-100 mt-2",children:"Por seguridad, debes cambiar tu contraseña"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsx("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-amber-800",children:["Bienvenido(a), ",C?.first_name||"Usuario"]}),e.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Esta es tu primera vez iniciando sesion. Por razones de seguridad, debes establecer una nueva contraseña antes de continuar."})]})]})}),m&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[e.jsx(A,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:m})]}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{label:"Correo Corporativo",type:"email",value:o,onChange:a=>f(a.target.value),placeholder:"tu.nombre@empresa.com",required:!0,autoFocus:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Este sera tu nuevo correo para iniciar sesion"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{label:"Nueva Contraseña",type:l?"text":"password",value:n,onChange:a=>g(a.target.value),placeholder:"Minimo 8 caracteres",required:!0}),e.jsx("button",{type:"button",onClick:()=>v(!l),className:"absolute right-3 top-[34px] text-gray-400 hover:text-gray-600 transition-colors",children:l?e.jsx(p,{className:"w-5 h-5"}):e.jsx(b,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{label:"Confirmar Nueva Contraseña",type:c?"text":"password",value:i,onChange:a=>j(a.target.value),placeholder:"Repite la contraseña",required:!0}),e.jsx("button",{type:"button",onClick:()=>w(!c),className:"absolute right-3 top-[34px] text-gray-400 hover:text-gray-600 transition-colors",children:c?e.jsx(p,{className:"w-5 h-5"}):e.jsx(b,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"font-medium mb-1",children:"Requisitos de la contraseña:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 text-gray-500",children:[e.jsx("li",{children:"Minimo 8 caracteres"}),e.jsx("li",{children:"No puede ser igual a tu numero de documento"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(h,{type:"button",variant:"secondary",onClick:P,className:"flex-1",children:"Cancelar"}),e.jsx(h,{type:"submit",loading:N,className:"flex-1",children:"Cambiar Contraseña"})]})]})]}),e.jsx("p",{className:"text-center text-amber-100 text-sm mt-6",children:"VALKYRIA ECM - Sistema de Gestion de Contenido Empresarial"})]})})}export{K as default};
