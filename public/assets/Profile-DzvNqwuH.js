import{j as e,b as K,u as X,c as M}from"./vendor-query-BtlmzfbD.js";import{r as c}from"./vendor-router-CyR0tpch.js";import{u as J,s as T,a as H}from"./index-CpR3368I.js";import{C as k,c as D,a as z,b as A}from"./Card-CVFC4agM.js";import{B as y}from"./Button-Cc42oWsS.js";import{I as P}from"./Input-DPOK3q6H.js";import{B as F}from"./Badge-Cv3EzJhT.js";import{v as W,R as Z,w as ee,K as Q,g as se,s as ae,B as U,x as te,T as re,A as le,y as ne,G as ie,q as ce,p as oe,z as de,I as G,S as me,J as $,P as q,O,Q as V,F as xe,V as ue,W as he,X as B,l as I,Y}from"./vendor-icons-YtD_Ipmm.js";import"./vendor-react-Cgg2GOmP.js";import"./vendor-axios-B9ygI19o.js";function pe({onSave:t,initialData:l=null,width:r=400,height:m=150,strokeColor:o="#000000",strokeWidth:x=2,disabled:u=!1}){const p=c.useRef(null),[n,g]=c.useState(!1),[s,b]=c.useState(!1),[j,w]=c.useState(null);c.useEffect(()=>{const i=p.current;if(!i)return;const f=i.getContext("2d");if(i.width=r,i.height=m,f.strokeStyle=o,f.lineWidth=x,f.lineCap="round",f.lineJoin="round",f.clearRect(0,0,r,m),l){const h=new Image;h.onload=()=>{f.drawImage(h,0,0),b(!0)},h.src=l.startsWith("data:")?l:`data:image/png;base64,${l}`}},[l,r,m,o,x]);const N=c.useCallback(i=>{const f=p.current,h=f.getBoundingClientRect(),a=f.width/h.width,E=f.height/h.height;return i.touches&&i.touches.length>0?{x:(i.touches[0].clientX-h.left)*a,y:(i.touches[0].clientY-h.top)*E}:{x:(i.clientX-h.left)*a,y:(i.clientY-h.top)*E}},[]),C=c.useCallback(i=>{if(u)return;i.preventDefault();const f=N(i);w(f),g(!0),b(!0)},[u,N]),_=c.useCallback(i=>{if(!n||u)return;i.preventDefault();const h=p.current.getContext("2d"),a=N(i);h.beginPath(),h.moveTo(j.x,j.y),h.lineTo(a.x,a.y),h.stroke(),w(a)},[n,u,j,N]),d=c.useCallback(()=>{if(g(!1),w(null),s&&t){const h=p.current.toDataURL("image/png").replace(/^data:image\/png;base64,/,"");t(h)}},[s,t]),S=c.useCallback(()=>{const i=p.current;if(!i)return;i.getContext("2d").clearRect(0,0,i.width,i.height),b(!1),t&&t(null)},[t]);return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg bg-white relative ${u?"bg-gray-50 cursor-not-allowed":"cursor-crosshair"}`,style:{width:"100%",maxWidth:r},children:[e.jsx("canvas",{ref:p,className:"w-full touch-none",style:{aspectRatio:`${r}/${m}`,maxHeight:m},onMouseDown:C,onMouseMove:_,onMouseUp:d,onMouseLeave:d,onTouchStart:C,onTouchMove:_,onTouchEnd:d}),!s&&!u&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none text-gray-400 text-sm",children:"Dibuje su firma aqui"})]}),!u&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button",onClick:S,className:"flex items-center gap-1 px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx(W,{className:"w-4 h-4"}),"Borrar"]}),e.jsxs("button",{type:"button",onClick:S,className:"flex items-center gap-1 px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx(Z,{className:"w-4 h-4"}),"Reiniciar"]})]})]})}const R=[{name:"Allura",family:"Allura, cursive"},{name:"Dancing Script",family:'"Dancing Script", cursive'},{name:"Great Vibes",family:'"Great Vibes", cursive'},{name:"Pacifico",family:"Pacifico, cursive"},{name:"Sacramento",family:"Sacramento, cursive"}],fe=[{name:"Negro",value:"#000000"},{name:"Azul Oscuro",value:"#1e3a5f"},{name:"Azul",value:"#2563eb"},{name:"Verde Oscuro",value:"#166534"},{name:"Gris",value:"#4b5563"}];function ge({defaultText:t="",defaultFont:l="Allura",defaultColor:r="#000000",defaultSize:m=48,onChange:o,disabled:x=!1}){const[u,p]=c.useState(t),[n,g]=c.useState(l),[s,b]=c.useState(r),[j,w]=c.useState(m),[N,C]=c.useState(!1);c.useEffect(()=>{(async()=>{const S=R.map(f=>f.name.replace(" ","+")).join("&family="),i=document.createElement("link");i.href=`https://fonts.googleapis.com/css2?family=${S}&display=swap`,i.rel="stylesheet",document.head.appendChild(i),i.onload=()=>C(!0)})()},[]),c.useEffect(()=>{o&&u&&o({styled_text:u,font_family:n,font_color:s,font_size:j})},[u,n,s,j,o]);const _=R.find(d=>d.name===n)?.family||"cursive";return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Texto de la firma"}),e.jsx("input",{type:"text",value:u,onChange:d=>p(d.target.value),placeholder:"Escriba su nombre o iniciales",disabled:x,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estilo de fuente"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:R.map(d=>e.jsxs("button",{type:"button",onClick:()=>g(d.name),disabled:x,className:`p-3 border rounded-lg text-left transition-all ${n===d.name?"border-primary-500 bg-primary-50 ring-2 ring-primary-200":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"} ${x?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[e.jsx("span",{style:{fontFamily:d.family,fontSize:"20px",color:s},children:u||"Firma"}),e.jsx("span",{className:"block text-xs text-gray-500 mt-1",children:d.name})]},d.name))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color de la firma"}),e.jsxs("div",{className:"flex gap-2",children:[fe.map(d=>e.jsx("button",{type:"button",onClick:()=>b(d.value),disabled:x,className:`w-8 h-8 rounded-full border-2 transition-all ${s===d.value?"ring-2 ring-offset-2 ring-primary-500":"hover:scale-110"} ${x?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,style:{backgroundColor:d.value},title:d.name},d.value)),e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[e.jsx("input",{type:"color",value:s,onChange:d=>b(d.target.value),disabled:x,className:"w-8 h-8 rounded cursor-pointer border border-gray-300",title:"Color personalizado"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Personalizado"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tamano: ",j,"px"]}),e.jsx("input",{type:"range",min:"24",max:"72",value:j,onChange:d=>w(Number(d.target.value)),disabled:x,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vista previa"}),e.jsx("div",{className:`p-4 border-2 border-dashed rounded-lg bg-white min-h-[80px] flex items-center justify-center ${N?"":"animate-pulse"}`,children:u?e.jsx("span",{style:{fontFamily:_,fontSize:`${j}px`,color:s},children:u}):e.jsx("span",{className:"text-gray-400",children:"Escriba su nombre para ver la vista previa"})})]})]})}function v({icon:t,label:l,value:r}){return e.jsxs("div",{className:"flex items-center gap-3 py-3 border-b border-gray-100 last:border-0",children:[e.jsx("div",{className:"p-2 bg-gray-50 rounded-lg",children:e.jsx(t,{className:"w-4 h-4 text-gray-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500",children:l}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r||"-"})]})]})}function L({title:t,children:l}){return e.jsxs(k,{children:[e.jsx(z,{children:e.jsx(A,{children:t})}),e.jsx(D,{children:l})]})}function je({used:t,total:l,label:r}){const m=l>0?Math.min(t/l*100,100):0;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:r}),e.jsxs("span",{className:"font-medium",children:[t," / ",l," días"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-500 rounded-full transition-all duration-300",style:{width:`${m}%`}})})]})}function ye({user:t,isOpen:l,onClose:r,onSuccess:m}){const[o,x]=c.useState({first_name:t?.first_name||"",last_name:t?.last_name||"",time_zone:t?.time_zone||"UTC",locale:t?.locale||"es"}),[u,p]=c.useState(""),n=M({mutationFn:s=>H.updateProfile(s),onSuccess:s=>{m(s.data.data),r()},onError:s=>{p(s.response?.data?.error||"Error al actualizar perfil")}}),g=s=>{s.preventDefault(),p(""),n.mutate(o)};return l?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Editar Perfil"}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(B,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:g,className:"p-4 space-y-4",children:[u&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:u})]}),e.jsx(P,{label:"Nombre",value:o.first_name,onChange:s=>x({...o,first_name:s.target.value}),required:!0}),e.jsx(P,{label:"Apellido",value:o.last_name,onChange:s=>x({...o,last_name:s.target.value}),required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Zona Horaria"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:o.time_zone,onChange:s=>x({...o,time_zone:s.target.value}),children:[e.jsx("option",{value:"UTC",children:"UTC"}),e.jsx("option",{value:"America/Mexico_City",children:"Ciudad de México (GMT-6)"}),e.jsx("option",{value:"America/Bogota",children:"Bogotá (GMT-5)"}),e.jsx("option",{value:"America/Lima",children:"Lima (GMT-5)"}),e.jsx("option",{value:"America/Santiago",children:"Santiago (GMT-4)"}),e.jsx("option",{value:"America/Buenos_Aires",children:"Buenos Aires (GMT-3)"}),e.jsx("option",{value:"America/Sao_Paulo",children:"São Paulo (GMT-3)"}),e.jsx("option",{value:"Europe/Madrid",children:"Madrid (GMT+1)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Idioma"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:o.locale,onChange:s=>x({...o,locale:s.target.value}),children:[e.jsx("option",{value:"es",children:"Español"}),e.jsx("option",{value:"en",children:"English"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:r,children:"Cancelar"}),e.jsxs(y,{type:"submit",loading:n.isPending,children:[e.jsx(Y,{className:"w-4 h-4"}),"Guardar Cambios"]})]})]})]})}):null}function be({isOpen:t,onClose:l}){const[r,m]=c.useState({current_password:"",new_password:"",confirm_password:""}),[o,x]=c.useState(""),[u,p]=c.useState(!1),n=M({mutationFn:s=>H.changePassword(s),onSuccess:()=>{p(!0),m({current_password:"",new_password:"",confirm_password:""}),setTimeout(()=>{l(),p(!1)},2e3)},onError:s=>{x(s.response?.data?.error||"Error al cambiar contraseña")}}),g=s=>{if(s.preventDefault(),x(""),r.new_password!==r.confirm_password){x("Las contraseñas no coinciden");return}if(r.new_password.length<8){x("La contraseña debe tener al menos 8 caracteres");return}n.mutate({current_password:r.current_password,password:r.new_password,password_confirmation:r.confirm_password})};return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Cambiar Contraseña"}),e.jsx("button",{onClick:l,className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(B,{className:"w-5 h-5"})})]}),u?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(G,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:"¡Contraseña actualizada!"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Tu contraseña ha sido cambiada exitosamente"})]}):e.jsxs("form",{onSubmit:g,className:"p-4 space-y-4",children:[o&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:o})]}),e.jsx(P,{label:"Contraseña Actual",type:"password",value:r.current_password,onChange:s=>m({...r,current_password:s.target.value}),required:!0}),e.jsx(P,{label:"Nueva Contraseña",type:"password",value:r.new_password,onChange:s=>m({...r,new_password:s.target.value}),required:!0,hint:"Mínimo 8 caracteres"}),e.jsx(P,{label:"Confirmar Nueva Contraseña",type:"password",value:r.confirm_password,onChange:s=>m({...r,confirm_password:s.target.value}),required:!0}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:l,children:"Cancelar"}),e.jsxs(y,{type:"submit",loading:n.isPending,children:[e.jsx(Q,{className:"w-4 h-4"}),"Cambiar Contraseña"]})]})]})]})}):null}function ve(){const t=K(),[l,r]=c.useState(!1),[m,o]=c.useState("drawn"),[x,u]=c.useState(""),[p,n]=c.useState(null),[g,s]=c.useState(null),[b,j]=c.useState(""),{data:w,isLoading:N}=X({queryKey:["signatures"],queryFn:()=>T.list()}),C=M({mutationFn:a=>T.create(a),onSuccess:()=>{t.invalidateQueries(["signatures"]),i()},onError:a=>{j(a.response?.data?.error||"Error al crear la firma")}}),_=M({mutationFn:a=>T.delete(a),onSuccess:()=>{t.invalidateQueries(["signatures"])},onError:a=>{const E=a.response?.data;E?.in_use?alert(`Esta firma está siendo utilizada en ${E.documents_count} documento(s). Desactívela en lugar de eliminarla.`):alert(E?.error||"Error al eliminar la firma")}}),d=M({mutationFn:a=>T.toggleActive(a),onSuccess:()=>{t.invalidateQueries(["signatures"])},onError:a=>{alert(a.response?.data?.error||"Error al cambiar estado de la firma")}}),S=M({mutationFn:a=>T.setDefault(a),onSuccess:()=>{t.invalidateQueries(["signatures"])}}),i=()=>{r(!1),o("drawn"),u(""),n(null),s(null),j("")},f=()=>{if(!x.trim()){j("El nombre de la firma es requerido");return}if(m==="drawn"&&!p){j("Por favor dibuje su firma");return}if(m==="styled"&&!g?.styled_text){j("Por favor ingrese el texto de su firma");return}const a={name:x,signature_type:m,...m==="drawn"?{image_data:p}:g};C.mutate(a)},h=w?.data?.data||[];return e.jsxs(k,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-primary-600"}),"Firma Digital"]}),e.jsxs(y,{size:"sm",onClick:()=>r(!0),children:[e.jsx(q,{className:"w-4 h-4"}),"Nueva Firma"]})]})}),e.jsxs(D,{children:[N?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})}):h.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx($,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No tienes firmas digitales configuradas"}),e.jsxs(y,{variant:"secondary",onClick:()=>r(!0),children:[e.jsx(q,{className:"w-4 h-4"}),"Crear mi primera firma"]})]}):e.jsx("div",{className:"space-y-4",children:h.map(a=>e.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-lg ${a.active?a.is_default?"border-primary-300 bg-primary-50":"border-gray-200":"border-gray-200 bg-gray-50 opacity-60"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsx("span",{className:`font-medium ${a.active?"":"text-gray-500"}`,children:a.name}),a.is_default&&a.active&&e.jsxs(F,{status:"approved",className:"text-xs",children:[e.jsx(O,{className:"w-3 h-3 mr-1"}),"Predeterminada"]}),e.jsx(F,{variant:"secondary",className:"text-xs",children:a.signature_type==="drawn"?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-3 h-3 mr-1"})," Dibujada"]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-3 h-3 mr-1"})," Estilizada"]})}),!a.active&&e.jsx(F,{status:"cancelled",className:"text-xs",children:"Desactivada"}),a.in_use&&e.jsxs(F,{variant:"secondary",className:"text-xs bg-blue-50 text-blue-700",children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),"En uso (",a.documents_count,")"]})]}),a.signature_type==="styled"&&e.jsx("p",{className:`text-2xl ${a.active?"":"opacity-50"}`,style:{fontFamily:`"${a.font_family}", cursive`,color:a.font_color},children:a.styled_text})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{size:"sm",variant:"secondary",onClick:()=>d.mutate(a.id),disabled:d.isPending,title:a.active?"Desactivar firma":"Activar firma",children:e.jsx(ue,{className:`w-4 h-4 ${a.active?"text-green-600":"text-gray-400"}`})}),!a.is_default&&a.active&&e.jsx(y,{size:"sm",variant:"secondary",onClick:()=>S.mutate(a.id),disabled:S.isPending,title:"Establecer como predeterminada",children:e.jsx(O,{className:"w-4 h-4"})}),e.jsx(y,{size:"sm",variant:"danger",onClick:()=>{if(a.in_use){alert(`Esta firma está siendo utilizada en ${a.documents_count} documento(s). Desactívela en lugar de eliminarla.`);return}confirm("¿Está seguro de eliminar esta firma?")&&_.mutate(a.id)},disabled:_.isPending||a.in_use,title:a.in_use?"No se puede eliminar, está en uso":"Eliminar firma",children:e.jsx(he,{className:"w-4 h-4"})})]})]},a.id))}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b sticky top-0 bg-white",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Nueva Firma Digital"}),e.jsx("button",{onClick:i,className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(B,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[b&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:b})]}),e.jsx(P,{label:"Nombre de la firma",value:x,onChange:a=>u(a.target.value),placeholder:"Ej: Firma formal, Iniciales, etc."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de firma"}),e.jsxs("div",{className:"flex border rounded-lg overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>o("drawn"),className:`flex-1 px-4 py-2 text-sm font-medium flex items-center justify-center gap-2 ${m==="drawn"?"bg-primary-500 text-white":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[e.jsx($,{className:"w-4 h-4"}),"Dibujar"]}),e.jsxs("button",{type:"button",onClick:()=>o("styled"),className:`flex-1 px-4 py-2 text-sm font-medium flex items-center justify-center gap-2 ${m==="styled"?"bg-primary-500 text-white":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(V,{className:"w-4 h-4"}),"Estilizada"]})]})]}),m==="drawn"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dibuje su firma"}),e.jsx(pe,{onSave:n,width:400,height:150})]}):e.jsx(ge,{onChange:s}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(y,{type:"button",variant:"secondary",onClick:i,children:"Cancelar"}),e.jsxs(y,{onClick:f,loading:C.isPending,children:[e.jsx(Y,{className:"w-4 h-4"}),"Guardar Firma"]})]})]})]})})]})]})}function Ne(t){return t?new Date(t).toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric"}):"-"}function we(t){if(!t)return"0 años";const l=Math.floor(t),r=Math.round((t-l)*12);return l===0&&r===0?"Menos de 1 mes":l===0?`${r} ${r===1?"mes":"meses"}`:r===0?`${l} ${l===1?"año":"años"}`:`${l} ${l===1?"año":"años"} y ${r} ${r===1?"mes":"meses"}`}function ze(){const{user:t}=J(),[l,r]=c.useState(!1),[m,o]=c.useState(!1),x=s=>{localStorage.setItem("user",JSON.stringify(s)),window.location.reload()},u=s=>{const b={admin:"bg-red-100 text-red-700",hr:"bg-purple-100 text-purple-700",legal:"bg-blue-100 text-blue-700",employee:"bg-green-100 text-green-700",viewer:"bg-gray-100 text-gray-700"};return b[s]||b.employee},p=s=>({admin:"Administrador",hr:"Recursos Humanos",legal:"Legal",employee:"Empleado",viewer:"Visor"})[s]||s,n=t?.vacation||{},g=t?.employee||{};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mi Perfil"}),e.jsx("p",{className:"text-gray-500",children:"Gestiona tu información personal y preferencias"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(k,{children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-3xl font-bold text-primary-600",children:[t?.first_name?.[0],t?.last_name?.[0]]})}),e.jsx("button",{className:"absolute bottom-0 right-0 p-2 bg-white rounded-full shadow-lg border hover:bg-gray-50",children:e.jsx(ee,{className:"w-4 h-4 text-gray-600"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?.full_name}),e.jsx("p",{className:"text-gray-500",children:t?.email}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[g.job_title," • ",g.department]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[t?.roles?.map(s=>e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${u(s)}`,children:p(s)},s)),t?.is_supervisor&&e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-700",children:"Supervisor"})]}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsx(y,{size:"sm",onClick:()=>r(!0),children:"Editar Perfil"}),e.jsxs(y,{size:"sm",variant:"secondary",onClick:()=>o(!0),children:[e.jsx(Q,{className:"w-4 h-4"}),"Cambiar Contraseña"]})]})]})]})})}),e.jsx(L,{title:"Información Laboral",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8",children:[e.jsx(v,{icon:se,label:"Número de Empleado",value:g.employee_number}),e.jsx(v,{icon:ae,label:"Cargo",value:g.job_title}),e.jsx(v,{icon:U,label:"Departamento",value:g.department}),e.jsx(v,{icon:te,label:"Fecha de Contratación",value:Ne(g.hire_date)}),e.jsx(v,{icon:re,label:"Antigüedad",value:we(n.years_of_service)}),e.jsx(v,{icon:le,label:"Años Completos",value:`${n.complete_years||0} años`})]})}),e.jsx(L,{title:"Información de Contacto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8",children:[e.jsx(v,{icon:ne,label:"Correo Electrónico",value:t?.email}),e.jsx(v,{icon:U,label:"Organización",value:"VALKYRIA Corp"})]})}),e.jsx(L,{title:"Preferencias",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8",children:[e.jsx(v,{icon:ie,label:"Idioma",value:t?.locale==="es"?"Español":"English"}),e.jsx(v,{icon:ce,label:"Zona Horaria",value:t?.time_zone||"UTC"})]})}),e.jsx(ve,{})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(z,{children:e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5 text-primary-600"}),"Vacaciones"]})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"text-center py-4 bg-primary-50 rounded-xl",children:[e.jsx("p",{className:"text-4xl font-bold text-primary-600",children:Math.floor(n.days_available||0)}),e.jsx("p",{className:"text-sm text-primary-700 mt-1",children:"Días disponibles"})]}),e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-700 font-medium",children:"Política: Ley Laboral Colombiana"}),e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[n.days_per_year||15," días hábiles por año de servicio"]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Días causados (total)"}),e.jsx("span",{className:"font-medium",children:Math.floor(n.days_accrued_total||0)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Días usados (total)"}),e.jsx("span",{className:"font-medium",children:Math.floor(n.days_used_total||0)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Días pendientes"}),e.jsx("span",{className:"font-medium text-primary-600",children:Math.floor(n.days_pending||0)})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Máximo acumulable"}),e.jsxs("span",{className:"font-medium",children:[n.max_accumulation_days||30," días"]})]})})]}),n.days_expiring>0&&e.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg flex items-start gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-yellow-800",children:[Math.floor(n.days_expiring)," días por vencer"]}),e.jsxs("p",{className:"text-xs text-yellow-600",children:["Exceden el máximo acumulable de ",n.max_accumulation_days," días"]})]})]}),n.can_compensate_cash&&e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx(G,{className:"w-4 h-4 inline mr-1"}),"Puedes compensar hasta ",n.max_cash_compensation," días en efectivo"]}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Disponible después de 4 años de servicio"})]}),e.jsx("div",{className:"pt-2",children:e.jsx(je,{used:n.days_used_total||0,total:n.days_accrued_total||0,label:"Días usados vs causados"})})]})]}),e.jsxs(k,{children:[e.jsx(z,{children:e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5 text-green-600"}),"Seguridad"]})}),e.jsxs(D,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Contraseña"}),e.jsx(F,{status:"approved",children:"Configurada"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Último acceso"}),e.jsx("span",{className:"text-sm text-gray-900",children:"Hoy"})]}),e.jsx(y,{variant:"secondary",size:"sm",className:"w-full mt-2",onClick:()=>o(!0),children:"Cambiar Contraseña"})]})]}),e.jsxs(k,{children:[e.jsx(z,{children:e.jsx(A,{children:"Permisos"})}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-2",children:[t?.permissions?.slice(0,6).map(s=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(G,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-gray-600",children:s==="*"?"Acceso completo":s.replace("."," - ")})]},s)),t?.permissions?.length>6&&e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["+",t.permissions.length-6," permisos más"]})]})})]})]})]}),e.jsx(ye,{user:t,isOpen:l,onClose:()=>r(!1),onSuccess:x}),e.jsx(be,{isOpen:m,onClose:()=>o(!1)})]})}export{ze as default};
